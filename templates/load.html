<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Load</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/load.css') }}">
</head>
<body>
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="{{ url_for('static', filename='js/lib/liteChart.min.js') }}"></script>
<div id="main">
            <h3>codename chu-chu *project name*</h3>
            <div id="tst">
                <fieldset id="main_lab">
                    <legend align="left">Edit mode</legend>
                    <div id="tst2">
<div id = "inf">
<div id="epoch">
<div class="epoch">
        <div class="progress-bar progress-bar-striped active"
            role="progressbar"
            v-bind:aria-valuenow="progress"
            aria-valuemin="0"
            aria-valuemax="100"
            v-bind:style="'width: '+progress+'%'"
        >
           epoch: <span class="progress-bar-label" v-text="progress + '%'"></span>
        </div>
    </div>
    <span v-text="message"></span>
</div>

<div id="iter">
<div class="iter">
        <div class="progress-bar progress-bar-striped active"
            role="progressbar"
            v-bind:aria-valuenow="progress"
            aria-valuemin="0"
            aria-valuemax="100"
            v-bind:style="'width: '+progress+'%'"
        >
           progress: <span class="progress-bar-label" v-text="progress + '%'"></span>
        </div>
    </div>
    <span v-text="message"></span>
</div>

<br/>
    <div id = "go_back">
         <form action="/modeFeed" method="POST" enctype="multipart/form-data">
            <button value="upload" type="submit">[to view mode]</button>
        </form>
    </div>
</div>
<div id="gra">
    <div id="your-id" style="height: 1000px; width: 1000px;"></div>
</div>
                    </div>
                </fieldset>
            </div>
<div id="copy">&copy Vladimir Lisovskij, 2019 <br/> made with <span id="red"><3</span></div>
</div>
    <script>
        let train_acc = [];
        let val_acc = []
        let i = 0;
        let labels = [];

        document.getElementById("go_back").style.display = "none";

    let app = new Vue({
        el: "#iter",
        data: {
            progress: 0,
            socket: null,
        },
        created: function() {
            socket = io.connect("http://" + document.domain + ":" + location.port + "/iter");
            socket.on("progress", (msg) => {
                this.progress = msg.text;
            });
        },
    });

    let app2 = new Vue({
        el: "#epoch",
        data: {
            progress: 0,
            socket: null,
        },
        created: function() {
            socket = io.connect("http://" + document.domain + ":" + location.port + "/epoch");
            socket.on("progress", (msg) => {
                this.progress = msg.text;
            });
        },
    });

    let app3 = new Vue({
        el: "#acc",
        data: {
            socket: null,
        },
        created: function() {
            socket = io.connect("http://" + document.domain + ":" + location.port + "/acc");
            socket.on("progress", (msg) => {
                train_acc.push(Number(msg.text[0]));
                val_acc.push(Number(msg.text[1]));
                labels.push(i);
                i++;
            });
        },
    });

    socket2 = io.connect("http://" + document.domain + ":" + location.port + "/test22");
    socket2.on("isConnected", function(data) {
    // Receive the 'data' and check if 'isConnected' is true

    if(data.isConnected === true) {
        // Now hide the div.
        document.getElementById("go_back").style.display = "inline-block";
    }

	// Create liteChart.js Object
	let d = new liteChart("chart", {
	    axisX: {
			show: true,
			color: "#e9edf1",
			width: 2,
			value: "",
		},
		axisY: {
			show: true,
			color: "#e9edf1",
			width: 2,
			value: "",
			minValue: 0,
			maxValue: 0,
		},
		line: {
			width: 2,
			style: "straight",
			shadow: true,
		},
		point: {
			show: false
		}
    });

        // Set labels
        d.setLabels(labels);
        // Set legends and values
        d.addLegend({"name": "train acc", "stroke": "#CDDC39", "values": train_acc});
        d.addLegend({"name": "val acc", "stroke": "#9e77dc", "values": val_acc});

        // Inject chart into DOM object
        let div = document.getElementById("your-id");
        d.inject(div);
        // Draw
        d.draw();

    });
    </script>
</body>
</html>